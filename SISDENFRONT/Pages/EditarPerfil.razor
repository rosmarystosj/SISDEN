@page "/editarperfil"
@layout NavLay
@inject LoginModelService LoginModel
@inject RegistroEntidadService RegistroServiceEntidad
@inject RegistroDenuncianteService RegistroService
@inject DenunciasService DenunciasService
@inject AuthService AuthService
@inject NavigationManager NavigationManager

<!DOCTYPE html>
<html lang="en">
    <head>   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="author" content="pixelstrap">
    <link rel="icon" href="../assets/images/favicon.png" type="image/x-icon">
    <link rel="shortcut icon" href="../assets/images/favicon.png" type="image/x-icon">
    <title>Riho - Premium Admin Template</title>
    <!-- Google font-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Font Awesome-->
    <link rel="stylesheet" type="text/css" href="../assets/css/font-awesome.css">
    <!-- Ico-font-->
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/icofont.css">
    <!-- Themify icon-->
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/themify.css">
    <!-- Flag icon-->
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/flag-icon.css">
    <!-- Feather icon-->
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/feather-icon.css">
    <!-- Plugins css start-->
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/slick.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/slick-theme.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/scrollbar.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/animate.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/echart.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/date-picker.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/datatables.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/owlcarousel.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/rating.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/photoswipe.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/rangeslider/rSlider.min.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/prism.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/fullcalender.css">
    <!-- Plugins css Ends-->
    <!-- Bootstrap css-->
    <link rel="stylesheet" type="text/css" href="../assets/css/vendors/bootstrap.css">
    <!-- App css-->
    <link rel="stylesheet" type="text/css" href="../assets/css/style.css">
    <link id="color" rel="stylesheet" href="../assets/css/color-1.css" media="screen">
    <!-- Responsive css-->
    <link rel="stylesheet" type="text/css" href="../assets/css/responsive.css"></head>
<body>
    <div class="loader-wrapper">
        <div class="loader">
            <div class="loader4"></div>
        </div>
    </div>
    <div class="tap-top"><i data-feather="chevrons-up"></i></div>
    <div class="page-wrapper compact-wrapper" id="pageWrapper">
        <div class="page-body-wrapper">
            <div class="page-body">
                <div class="container-fluid">
                    <div class="page-title">
                        <div class="row">
                            <div class="col-6">
                                <h4>Editar Perfil</h4>
                            </div>
                            <div class="col-6">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item">
                                        <a href="/index">
                                            <svg class="stroke-icon">
                                                <use href="../assets/svg/icon-sprite.svg#stroke-home"></use>
                                            </svg>
                                        </a>
                                    </li>
                                    <li class="breadcrumb-item">Tu Cuenta</li>
                                    <li class="breadcrumb-item active"> Editar Perfil</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="container-fluid">
                    <div class="edit-profile">
                        <div class="row">
                            <div class="col-xl-4">
                                
                            </div>
                            <div class="col-xl-8">
                                <form class="card">
                                    <div class="card-header">
                                        <h4 class="card-title mb-0">Editar Perfil</h4>
                                        <div class="card-options"><a class="card-options-collapse" href="#" data-bs-toggle="card-collapse"><i class="fe fe-chevron-up"></i></a><a class="card-options-remove" href="#" data-bs-toggle="card-remove"><i class="fe fe-x"></i></a></div>
                                    </div>
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-5">
                                                <div class="mb-3">
                                                    <label class="form-label">Cédula</label>
                                                    <input class="form-control" type="text" placeholder="Cedula" @bind="registromodelo.Usuidentificacion">
                                                </div>
                                            </div>
                                           
                                            <div class="col-sm-6 col-md-4">
                                                <div class="mb-3">
                                                    <label class="form-label">Correo Electronico</label>
                                                    <input class="form-control" type="email" placeholder="Email" @bind="registromodelo.Usuemail">
                                                </div>
                                            </div>
                                            <div class="col-sm-6 col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">Nombre</label>
                                                    <input class="form-control" type="text" placeholder="Nombre" @bind="registromodelo.Usunombre">
                                                </div>
                                            </div>
                                            <div class="col-sm-6 col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">Apellidos</label>
                                                    <input class="form-control" type="text" placeholder="Apellidos" @bind="registromodelo.Usuapellido">
                                                </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="mb-3">
                                                    <label class="form-label">Direccion</label>
                                                    <input class="form-control" type="text" placeholder="Calle, Sector...">
                                                </div>
                                            </div>
                                            <div class="col-sm-6 col-md-4">
                                                <div class="mb-3">
                                                    <label class="form-label">Teléfono</label>
                                                    <input class="form-control" type="text" placeholder="Segundo Teléfono" @bind="registromodelo.Usutelefono">
                                                </div>
                                            </div>
                                            <div class="col-sm-6 col-md-3">
                                                <div class="mb-3">
                                                    <label class="form-label">Segundo Teléfono</label>
                                                    <input class="form-control" type="number" placeholder="000-000-0000" @bind="registromodelo.Usutelefono2">
                                                </div>
                                            </div>


                                        </div>
                                    </div>
                                    <div class="card-footer text-end">
                                        <button class="btn btn-primary"  href="/index"  type="submit">Actualizar Perfil</button>
                                    </div>
                                </form>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <footer class="footer">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-12 footer-copyright text-center">
                            <p class="mb-0">Copyright 2024 © Riho theme by pixelstrap  </p>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap/bootstrap.bundle.min.js"></script>
<script src="../assets/js/icons/feather-icon/feather.min.js"></script>
<script src="../assets/js/icons/feather-icon/feather-icon.js"></script>
<script src="../assets/js/scrollbar/simplebar.js"></script>
<script src="../assets/js/scrollbar/custom.js"></script>
<script src="../assets/js/config.js"></script>
<script src="../assets/js/sidebar-menu.js"></script>
<script src="../assets/js/sidebar-pin.js"></script>
<script src="../assets/js/slick/slick.min.js"></script>
<script src="../assets/js/slick/slick.js"></script>
<script src="../assets/js/header-slick.js"></script>
<script src="../assets/js/chart/apex-chart/apex-chart.js"></script>
<script src="../assets/js/chart/apex-chart/stock-prices.js"></script>
<script src="../assets/js/chart/apex-chart/moment.min.js"></script>
<script src="../assets/js/chart/echart/esl.js"></script>
<script src="../assets/js/chart/echart/config.js"></script>
<script src="../assets/js/chart/echart/pie-chart/facePrint.js"></script>
<script src="../assets/js/chart/echart/pie-chart/testHelper.js"></script>
<script src="../assets/js/chart/echart/pie-chart/custom-transition-texture.js"></script>
<script src="../assets/js/chart/echart/data/symbols.js"></script>
<script src="../assets/js/form-wizard/form-wizard.js"></script>
<script src="../assets/js/form-wizard/image-upload.js"></script>
<script src="../assets/js/height-equal.js"></script>
<script src="../assets/js/owlcarousel/owl.carousel.js"></script>
<script src="../assets/js/ecommerce.js"></script>
<script src="../assets/js/rating/rating-script.js"></script>
<script src="../assets/js/rating/jquery.barrating.js"></script>
<script src="../assets/js/range-slider/rSlider.min.js"></script>
<script src="../assets/js/rangeslider/rangeslider.js"></script>
<script src="../assets/js/prism/prism.min.js"></script>
<script src="../assets/js/clipboard/clipboard.min.js"></script>
<script src="../assets/js/counter/jquery.waypoints.min.js"></script>
<script src="../assets/js/counter/jquery.counterup.min.js"></script>
<script src="../assets/js/counter/counter-custom.js"></script>
<script src="../assets/js/custom-card/custom-card.js"></script>
<script src="../assets/js/form-wizard/verification.js"></script>
<script src="../assets/js/tooltip-init.js"></script>
<script src="../assets/js/datepicker/date-picker/datepicker.js"></script>
<script src="../assets/js/datepicker/date-picker/datepicker.en.js"></script>
<script src="../assets/js/datepicker/date-picker/datepicker.custom.js"></script>
<script src="../assets/js/dashboard/dashboard_3.js"></script>
<script src="../assets/js/datatable/datatables/jquery.dataTables.min.js"></script>
<script src="../assets/js/datatable/datatables/datatable.custom.js"></script>
<script src="../assets/js/script.js"></script>
<script src="../assets/js/calendar/fullcalender.js"></script>
<script src="../assets/js/calendar/custom-calendar.js"></script>
<script src="../assets/js/dashboard/dashboard_2.js"></script>
<script src="../assets/js/animation/wow/wow.min.js"></script>
<script src="../assets/js/cleave/cleave.min.js"></script>
<script src="../assets/js/cleave/custom-cleave.js"></script>
<script src="../assets/js/height-equal.js"></script>
<script>new WOW().init();</script>

</body>
</html>
@code {
    private RegistroModelo registromodelo = new RegistroModelo();
    private string errorMessage;
    private VistaUsuario user = new VistaUsuario();
    private string correo;

    protected override async Task OnInitializedAsync()
    {
        try
        {

            if (LoginModel.LoginModel?.UsuRol == 1 || LoginModel.LoginModel?.UsuRol == 2)
            {
                correo = LoginModel.LoginModel.Usuemail;
                user = await AuthService.ObtenerUsuarioAsync(correo);

            }
            else if (RegistroService.RegistroModelo?.Usurol == 1)
            {
                correo = RegistroService.RegistroModelo.Usuidentificacion;
                user = await AuthService.ObtenerUsuarioAsync(correo);
            }
          
            else if (RegistroServiceEntidad.EntidadModelo?.Usurol == 2)
            {
                correo = RegistroServiceEntidad.EntidadModelo.Usuemail;
                user = await AuthService.ObtenerUsuarioAsync(correo);
            }
        }
        catch (HttpRequestException httpEx)
        {
            errorMessage = "Network error occurred: " + httpEx.Message;
            Console.WriteLine(httpEx);
        }
        catch (Exception ex)
        {
            errorMessage = "An error occurred while loading entities: " + ex.Message;
            Console.WriteLine(ex);
        }
    }
    private async Task HandleRegister()
    {
        try
        {
            errorMessage = null;
            var resultado = await AuthService.EditarUsuario(registromodelo);
            NavigationManager.NavigateTo("/index");
        }
        catch (ApplicationException ex)
        {
            errorMessage = ex.Message;
        }
        catch (Exception ex)
        {
            errorMessage = "Ocurrio un error inesperado.";
            Console.WriteLine(ex.Message);
        }
    }


}
